(function(C){var B=C.u.d;B.homeURL=document.URL;var A=function(){return this};A.prototype.replaceHistory=function(E,F,D){if(!pega.desktop.support.getFrameElement()&&window.history.replaceState){window.history.replaceState(E,F,D)}};B.HistoryManager=A})(pega);var harCtxMgr=pega.ui.HarnessContextMgr;if(harCtxMgr.get("bIsDCSPA")){function linkPreventDefault(C){var C=C||window.event;var A=$(C.target).closest("a");if(A.length==0){return }var B=A.attr("href");if(B&&B.indexOf("#")===0){if(B.length>1){pega.u.d.isAnchorNav=true}else{C.preventDefault()}}}if(document.addEventListener){document.addEventListener("click",linkPreventDefault,false)}else{document.attachEvent("onclick",linkPreventDefault)}}if(!pega.u.d.popEventAdded&&harCtxMgr.get("bIsDCSPA")){window.addEventListener("popstate",function(B){var A=B.state?B.state.index:0;if(pega.ui.DCUtil.historyGlobalState==A){return }var H;if(B.state==null||B.state.mspPortalInitialLoad){if(pega.u.d.isAnchorNav){delete pega.u.d.isAnchorNav;return }if(pega.u.d.isBackToPreview){delete pega.u.d.isBackToPreview;return }H=SafeURL_createFromURL(pega.u.d.homeURL);var D=H.get("pyActivity");var C=H.get("pyPreActivity");if(D=="%40baseclass.pzProcessURLInWindow"&&C=="Embed-PortalLayout.RedirectAndRun"){H.remove("pyActivity");var F=H.get("ThreadName");H.remove("ThreadName");var I=H.get("Location");var G=new SafeURL_createFromEncryptedURLwithQueryString(I);H.remove("Location");var E=H.get("pxReqURI").replace("STANDARD",F);G.put("pxReqURI",E);H=G}H.put("isHistoryStateNull","true")}else{H=SafeURL_createFromURL(B.state.url)}H.put("isURLReady","true");H.put("isDCSPA","true");H.put("isFromHistory","true");if(B.state&&B.state.isActivateDocument){H.put("api","activate")}pega.u.d.setBusyIndicator(document.body,true,true);pega.u.d.UIActionRouter.singlePageRenderer(H,null,null,B)});function setPortalBaseref(){var F=["header","aside","footer"];for(var E in F){var D=F[E];var C=document.querySelectorAll(".screen-layout > "+D);if(C&&C.length>0){var G=C.length;for(var B=0;B<G;B++){var A=C[B];A.setAttribute("name","BASE_REF");A.setAttribute("base_ref","pyPortalHarness")}}}}function displayAction(G){var I=G.pyParameters;var F=G.pyActionAPI;newRecreateURL=new SafeURL();newRecreateURL.put("pyActivity","@baseclass.doUIAction");newRecreateURL.put("isSDM","true");if(I.accessFromServer){newRecreateURL.put("accessFromServer",I.accessFromServer)}newRecreateURL.put("action","display");newRecreateURL.put("api","display");if(F.pyCoverClass){newRecreateURL.put("className",F.pyCoverClass)}if(I.contentID){newRecreateURL.put("contentID",I.contentID)}if(G.pyTabGroupName){newRecreateURL.put("dynamicContainerID",G.pyTabGroupName)}if(F.pyHarnessName){newRecreateURL.put("harnessName",F.pyHarnessName)}if(I.SkipConflictCheck){newRecreateURL.put("SkipConflictCheck",I.SkipConflictCheck)}if(I.portalName){newRecreateURL.put("portalName",I.portalName)}else{if(pega.ui&&pega.ui.NavigateTopHandler&&pega.ui.NavigateTopHandler.portalName){newRecreateURL.put("portalName",pega.ui.NavigateTopHandler.portalName)}}if(I.portalThreadName){newRecreateURL.put("portalThreadName",I.portalThreadName)}newRecreateURL.put("tabIndex",1);if(I.inStandardsMode){newRecreateURL.put("inStandardsMode",I.inStandardsMode)}if(F.pyActivity){newRecreateURL.put("preActivity",F.pyActivity);try{var L=F.preActivityParams;if(L){var E=F.preActivityDynamicParams;newRecreateURL.put("preActivityParams",L);if(E){newRecreateURL.put("preActivityDynamicParams",E)}}}catch(N){}}var C=F.pyReadOnly;C=(("0"==C||"false"==C)?"false":"true");newRecreateURL.put("readOnly",C);if(F.model){try{var M=F.model;if(M){var O=F.pyDataTransformDynamicParams;newRecreateURL.put("model",M);if(O){newRecreateURL.put("pyDataTransformDynamicParams",O)}}}catch(N){}}if(G.openlanding=="openlanding"){newRecreateURL.put("readOnly",F.pyReadOnly);newRecreateURL.put("action","Display");newRecreateURL.put("landingAction","openlanding");newRecreateURL.put("label",F.pyTitle);newRecreateURL.put("model",F.model);var D=F.levelA||"",B=F.levelB||"",A=F.levelC||"",H=F.paramKeys;if(typeof H!="undefined"&&H){H=H.replace(/&amp;/g,"&");var K=H.split("&");H="";for(var J=0;J<K.length;J++){if(H){H=H+"&"}H=H+K[J];var P=F[K[J]];if(P){newRecreateURL.put(K[J],P)}}if(H){newRecreateURL.put("paramKeys",H)}}if(D){newRecreateURL.put("levelA",D)}if(B){newRecreateURL.put("levelB",B)}if(A){newRecreateURL.put("levelC",A)}}newRecreateURL.put("isDCSPA","true");newRecreateURL.put("isURLReady","true");newRecreateURL.put("isReloaded","true");return newRecreateURL}window.addEventListener("load",function(A){if(pega.ctx.bMultiPortalSession){var H=SafeURL_createFromEncryptedURLwithQueryString(pega.u.d.homeURL);var J=H.get("Location");if(J){var M=decodeURIComponent(J);if(M.indexOf("mSessionThreadName")==-1){M=M+"&mSessionThreadName="+pega.u.d.getThreadName()}var L=encodeURIComponent(M);H.put("Location",L);pega.ui.NavigateTopHandler.historyManager.replaceHistory("",document.title,H.toURL())}else{var E=pega.u.d.homeURL;var N="";if(pega.ctx.pyMultiSessionCount==""){N="default"}else{N=pega.u.d.getThreadName()}if(pega.u.d.homeURL.indexOf("?")==-1){N="?mSessionThreadName="+N}else{N="&mSessionThreadName="+N}if(E.indexOf("mSessionThreadName")==-1){E=E+N}pega.u.d.homeURL=E;pega.ui.NavigateTopHandler.historyManager.replaceHistory("",document.title,E);history.pushState({title:document.title,url:E,index:pega.ui.DCUtil.historyGlobalState,mspPortalInitialLoad:true},document.title,E)}}if(pega.u.d.skipDocsRecreation){return }setPortalBaseref();var F=new pega.ui.busyIndicator(busyIndText,true,document.body,pega.u.d.busyIndInterval);var G={success:function(){F.hide()},failure:function(){F.hide()}};var K=document.querySelector("textarea#docsRecreateInfo");if(history.state){var H=SafeURL_createFromURL(decodeURIComponent(history.state.url));if(H.get("api")=="activate"&&H.get("index")==0){return }pega.ui.DCUtil.historyGlobalState=history.state.index}if(K){var C=JSON.parse(K.innerText);if(C instanceof Array){C=C[0];if(C&&C.pyIsStatic=="false"){F.show(true,true);var I=C.pyAction;var D;if(I=="display"){D=displayAction(C)}else{var B=true;D=pega.ui.DCUtil.rewriteURL(K,B);D.put("isURLReady","true");D.put("isReloaded","true");D.put("isDCSPA","true");B=false}if(D){pega.u.d.UIActionRouter.singlePageRenderer(D,null,G)}C=null}}}});pega.u.d.popEventAdded=true}(function(e){var i=e.desktop,Q=null,G=i.support,B=e.util.Dom,X=e.u,c=e.u.d,b=e.util.Event,C="contentID",V="DesktopAction",W="openAssignment",g="openWorkByHandle",a="openWorkByURL",f="createNewWork",A="display",M="showHarness",Z="openWorkItem",P="getNextWork",Y="openWizard",U="WorkLoaded",E="openLanding",D="runFlow",N="refresh",R="api",S="action",O="landingAction",K="param",H="FlowType",d="clearIndicators",T="submitDocumentContent",J="workpool",I={},F="",L="",j=function(){return B.getElementsByAttribute.apply(B,arguments)},h=function(){return B.getElementsById.apply(B,arguments)};X.NavigateTopHandler=new function(){var r;var AJ=false;var s=pega.ui.HarnessContextMgr;var m=function(){if(!AJ){AJ=true}if(pega&&pega.u&&pega.u.d){if(!F){F=pega.u.d.getThreadName()}if(!L){L=s.get("portalName");this.portalName=L}}B.addClass(document.body,"with-fixed-header");this.historyManager=new c.HistoryManager();if(!pega.u.d.isHistoryReplaced){AK(this.historyManager)}var AN=G.getDesktopApplication(),AL=AN?AN.gadgetPool:Q,AM;if(!AL){return }r=c.fieldValuesList;AM=AL.findAvailableGadget();if(AM){return }if(this!=AM){i.registerDocumentGadget(this);i.registerEventListener(V,o);this.gadgetName="NavigateTopHandler";this.gadgetAvailable=true;if(typeof checkContainersExpanded==="function"){checkContainersExpanded()}}};var o=function(AP){var AQ=AP.get(C),AO=AP.get(R),AL=z(),AN="";if(!AQ){AQ=AG();AP.put(C,AQ)}if(AL){AP.put("dynamicContainerID",AL)}removeScreenLayoutMask();var AM=function(){try{var AR={online:c.UIActionRouter.onlineHandler,offline:c.UIActionRouter.offlineHandler,scope:u};AC();pega.u.d.setBusyIndicatorWithDelay(document.body,300);c.ServerProxy.doAction(AP,null,AR,null)}catch(AS){}};if(pega.ui&&pega.ui.DCUtil&&pega.ui.DCUtil.startTransition){pega.ui.DCUtil.startTransition(true,AM)}else{AM()}};var AC=function(){c.ServerProxy.forceDestinationIfOSCOProcessing()};var p=function(AM,AO){if(pega.ui&&pega.ui.DCUtil&&pega.offline){pega.ui.DCUtil.isLoadingInProgress=true}if(pega.mobile&&pega.mobile.hybrid&&pega.mobile.hybrid.getLaunchBox()&&pega.mobile.hybrid.getLaunchBox().NativePageSwitcher){var AL=pega.mobile.hybrid.getLaunchBox();var AN=function(){pega.u.d.resumeAjaxSequencer();if(typeof AO==="function"){AO()}};pega.u.d.pauseAjaxSequencer();AL.NativePageSwitcher.startSwitching(AM,AN);return }if(typeof AO==="function"){AO()}};var AD=function(){if(pega.ui&&pega.ui.DCUtil&&pega.offline){pega.ui.DCUtil.isLoadingInProgress=false;if(typeof pega.ui.DCUtil.onLoadingFinished==="function"){pega.ui.DCUtil.onLoadingFinished();pega.ui.DCUtil.onLoadingFinished=undefined}}if(pega.mobile&&pega.mobile.hybrid&&pega.mobile.hybrid.getLaunchBox()){var AL=pega.mobile.hybrid.getLaunchBox();if(AL.NativePageSwitcher){setTimeout(function(){AL.NativePageSwitcher.continueSwitching()},100)}}};var y=function(){if(pega.ui&&pega.ui.DCUtil&&pega.offline){pega.ui.DCUtil.isLoadingInProgress=false;if(typeof pega.ui.DCUtil.onLoadingFinished==="function"){pega.ui.DCUtil.onLoadingFinished();pega.ui.DCUtil.onLoadingFinished=undefined}}if(pega.mobile&&pega.mobile.hybrid&&pega.mobile.hybrid.getLaunchBox()){var AL=pega.mobile.hybrid.getLaunchBox();if(AL.NativePageSwitcher){AL.NativePageSwitcher.cancelSwitching()}}};var k=function(AQ,AP){var AO=$("main a#appview-nav-toggle-one").get(0);var AN=$("main a#appview-nav-toggle-two").get(0);var AL;if(pega.u.d.bIsDCSPA&&pega.u.d.replaceWorkArea){AL=$("#workarea").get(0)}else{AO=$("main a#appview-nav-toggle-one").get(0);AN=$("main a#appview-nav-toggle-two").get(0);if(AO||AN){AL=$(".screen-layout-region-main-middle .screen-layout-region-content").get(0)}if(!AL){AL=$(".screen-layout-region-main-middle").get(0)}}if(pega.u.d.ServerProxy&&pega.u.d.ServerProxy.isHybridClient()){AI()}pega.ui.EventsEmitter.publishSync("BeforeDCUpdate",{targets:AL});var AM=function(AR){if(!pega.u.d.bIsDCSPA||!document.body.getAttribute("data-harness-id")){document.body.setAttribute("data-harness-id",pega.ctx.pzHarnessID);document.body.classList.add(pega.ctx.pzHarnessID)}pega.ctx.baseFrameName=SafeURL_createFromURL(pega.u.d.url).get("pzFromFrame");if(typeof AP==="function"){AP(AR)}else{pega.u.d.loadHTMLEleCallback(AR)}pega.ui.EventsEmitter.publishSync("AfterDCUpdate",{targets:AL})};pega.u.d.cleanUpHarnessElements(null,[AL]);pega.u.d.loadDOMObject(AL,AQ,AM);AD();delete document.actionForm};var AI=function(){var AO=$(".screen-layout-region-main-middle").get(0);try{if(pega.u.d.firstBaseRefElement&&$.contains(AO,pega.u.d.firstBaseRefElement)){pega.u.d.firstBaseRefElement=null}if(pega.u.d.focusElement&&$.contains(AO,pega.u.d.focusElement)){pega.u.d.focusElement=null}if(pega.u.d.gBusyInd&&pega.u.d.gBusyInd._sNode&&$.contains(AO,pega.u.d.gBusyInd._sNode)){pega.u.d.gBusyInd._sNode=null}var AL=[];for(var AM in window.validationElements){if(!$.contains(AO,AM)){AL.push(window.validationElements[AM])}}window.validationElements=AL}catch(AN){}if(pega.u.d.conditionsMap){pega.u.d.conditionsMap={}}};var AF=function(){var AN=document.getElementById("PEGA_HARNESS");if(AN){var AL=AN.getAttribute("node_name");var AM=AN.getAttribute("data-primary-page-class");pega.u.d.ServerProxy.displayHarness(AL,AM)}else{pega.desktop.activateDocument(0)}};var w=function(AT,AW){if(pega.ui.HarnessContextMgr.get("bIsDCSPA")){return false}if((pega.u.d.ServerProxy.isBrowserClient()&&!(AL&&pega.ui.rdlMasterDetails.getActiveRDLMetaInfo().isOnlineWOBound))||!(AW=="click"||AW=="focusin")){return }var AV=document.getElementById("pega_ui_mask");if(AV&&AV.contains(AT)){return }var AO=pega.ctx.dom.getElementById("PEGA_HARNESS"),AL=pega.ctx.dom.querySelector(".RDLShowDetails.open"),AM=F||"STANDARD",AS=(AO&&AO.getAttribute("thread_name"))||AM;if(AS!=="NONOSCOThread"&&!AL){pega.u.d.baseThreadName=AM;pega.ui.DCUtil.isActionFromNonOsco=false;return }if(typeof pega.util.Dom.inDocument=="function"&&!pega.util.Dom.inDocument(AT)){return }var AP=pega.u.d.modalDialog&&pega.u.d.modalDialogLoaded()&&document.getElementById("modalOverlay").contains(AT);if(AP){return }var AQ=(pega.u.d&&pega.u.d.getPopOverLevel&&pega.u.d.getPopOverLevel(AT))>=0;if(AQ){return }var AU=$(AT).closest(".menu-panel-wrapper").length>0&&pega.c.menu&&AO&&AO.contains(pega.c.menu.showMenuTarget);if(AU){return }var AR;pega.ui.DCUtil.isActionFromNonOsco=false;if(AL){if(pega.ui.rdlMasterDetails.getActiveRDLMetaInfo().isOnlineWOBound){AR=pega.ui.rdlMasterDetails.getWorkProcessingThread();if(!$(AT).closest(".secondarySection")[0]){AR=AS;pega.u.d.ServerProxy.setDestination(pega.u.d.ServerProxy.DESTINATION.LOCAL)}else{pega.u.d.ServerProxy.setDestination(pega.u.d.ServerProxy.DESTINATION.REMOTE)}}}else{var AN=AO&&AO.contains(AT);if(AN){if(pega.u.ChangeTrackerMap.getTrackers()["NONOSCOThread"]){AR="NONOSCOThread";pega.ui.DCUtil.isActionFromNonOsco=true;pega.u.d.ServerProxy.setDestination(pega.u.d.ServerProxy.DESTINATION.REMOTE)}}else{AR=AM;pega.u.d.ServerProxy.setDestination(pega.u.d.ServerProxy.DESTINATION.LOCAL)}}if(AR){pega.u.d.switchThread(AR);pega.ui.ClientCache.init(AR);if(!AL){pega.u.d.baseThreadName=AR}}};var l=function(){var AL=$("#workarea");if(AL.length>0){return true}return false};var AA=function(AM){var AN=AM.params,AL,AP=new SafeURL();AP.put("pyActivity","@baseclass.doUIAction");AP.put("isSDM","true");if(AM.action==E){AP.put(O,AM.action)}else{if(AM.action.toLowerCase()!=a){AP.put(S,AM.action)}}AP.put("portalName",L);AP.put("portalThreadName",F);AP.put("tabIndex",1);for(var AO in AN){AL=AN[AO];if(AL==""||AL==undefined){continue}AP.put(AO,AL)}return AP};var AE=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};var AG=function(){return(AE()+AE()+"-"+AE()+"-"+AE()+"-"+AE()+"-"+AE()+AE()+AE())};var z=function(){var AN=document.querySelector(".dc-main"),AL="",AM=document.getElementById("docsRecreateInfo");if(AN){AL=AN.getAttribute("tabgroupname")}else{if(AM){AM=JSON.parse(AM.innerHTML)[0];if(AM&&AM.pyTabGroupName){AL=AM.pyTabGroupName}}}return AL};var AH=function(AM){var AL={online:c.UIActionRouter.onlineHandler,offline:c.UIActionRouter.offlineHandler,scope:u};AC();pega.u.d.setBusyIndicator(document.body,true,true);c.ServerProxy.doAction(AM,null,AL,null);removeScreenLayoutMask()};var q=function(AN){var AM=pega.ui.ClientCache,AO,AP,AL="HOME";if(!AM){return }switch(AN){case"getNextWork":case Z:case W:case g:case a:case f:case D:AL="WORK";break;case A:case M:AL="HARNESS";break;case E:AL="LANDING";break;case Y:AL="WIZARD";break}AP=AM.find("Declare_pyDisplay");if(!AP){AP=AM.createPage("Declare_pyDisplay")}AO=AM.find("Declare_pyDisplay.pyDCDisplayState");if(!AO){AO=AP.put("pyDCDisplayState",AM.createPage("pyDCDisplayState"))}AO.put("pyActiveDocumentType",AL)};var n=function(AS,AL){var AP=$("#PEGA_HARNESS div[node_name='pzActionAreaContent']");if((!AL)&&(pega.u.d.formPost!="TRUE"&&AP.length==0&&window.strHarnessMode!=undefined&&window.strHarnessMode.toLowerCase()!="action")){return }if(AS){var AM=JSON.parse(AS.innerHTML);AM=AM?AM[0]:null;if(AM){var AO;var AQ=false;var AN=AM.pyAction;var AR=AM.pyKey;if((AR&&AR!=""&&AR.match("[-]*[0-9.]*T$"))||AN=="reportdefinition"){AQ=true}if(AQ){AO={action:"displayOnPage",params:{renderAction:"displayOnPage",pzPrimaryPage:AM.pzPrimaryHarnessPageName,className:AM.pzPrimaryHarnessPageClass,harnessName:AM.pyStreamName,SkipConflictCheck:true,contentID:AM.pyElementName,dynamicContainerID:AM.pyTabGroupName}}}else{AO={action:"openWorkByHandle",params:{api:"openWorkByHandle",SkipConflictCheck:true,key:AM.pyKey,contentID:AM.pyElementName,dynamicContainerID:AM.pyTabGroupName}};if(AM.pyAssignmentKey!=""&&AM.pyAssignmentKey!=undefined){AO.action="openAssignment";AO.params["api"]="openAssignment";AO.params["key"]=AM.pyAssignmentKey}}var AT=window.navigator.userAgent;if(AT.match(/iPad/i)||AT.match(/iPhone/i)){AB()}return AA(AO)}}};var AK=function(AM){pega.u.d.isHistoryReplaced=true;var AQ=typeof pmcRuntimeFeatures!=="undefined"&&pmcRuntimeFeatures.pxUsesOffline==="true";var AP=document.getElementById("docsRecreateInfo");if(AP){var AL=JSON.parse(AP.innerHTML);AL=AL?AL[0]:null;if(AL){var AR=n(AP);if(typeof AR=="object"&&AR.name=="safeURL"){AM.replaceHistory(null,AL.pyLabel,AR.toURL())}}}else{if(!pega.ui.HarnessContextMgr.get("bIsDCSPA")&&!AQ){var AO=window.location.href;if(AO.indexOf("fromBrowserHistory=true")==-1){if(!AO.match(/\?./)){AO=AO+"?"}else{if(!(/\&$/.test(AO))){AO=AO+"&"}}AO=AO+"fromBrowserHistory=true";AM.replaceHistory(null,document.title,AO)}}}var AO=window.location.href;if(AO.indexOf("bPurgeTargetThread=true")!==-1){var AN=SafeURL_createFromURL(AO);AN.remove("bPurgeTargetThread");AM.replaceHistory(null,document.title,AN.toURL());AN=null}};var AB=function(){$(window).bind("pageshow",function(AL){if(AL.originalEvent.persisted){window.location.reload()}})};var u=this;var t=(navigator.userAgent.toLowerCase().indexOf("pegamobilesdk")!=-1);var x=!pega.ui.HarnessContextMgr.get("bIsDCSPA");if(c.gIsScriptsLoading){c.attachOnload(function(){AJ=true;m.call(u)},x)}else{c.attachOnload(function(){m.call(u)},x)}var v=function(){if(typeof pega.desktop.AppControllerLite!="undefined"){return true}else{return false}};this.dcViewUpdate=k;this.dcViewRefresh=AF;this.setActiveDocumentType=q;this.runFlow=AH;this.setContextThread=w;this.getActiveDocumentType=function(){var AL=pega.ui.ClientCache.find("Declare_pyDisplay.pyDCDisplayState.pyActiveDocumentType"),AM="";if(AL){AM=AL.getValue()}return AM};this.getPrimaryThreadName=pega.u.d.getThreadName();this.startTransition=p;this.continueTransition=AD;this.cancelTransition=y;this.rewriteURL=n;this.isWithPortalController=v};X.DCUtil=new function(){this.refresh=pega.ui.NavigateTopHandler.dcViewRefresh;this.replace=pega.ui.NavigateTopHandler.dcViewUpdate;this.startTransition=pega.ui.NavigateTopHandler.startTransition;this.continueTransition=pega.ui.NavigateTopHandler.continueTransition;this.cancelTransition=pega.ui.NavigateTopHandler.cancelTransition;this.setActiveDocumentType=pega.ui.NavigateTopHandler.setActiveDocumentType;this.getActiveDocumentType=pega.ui.NavigateTopHandler.getActiveDocumentType;this.setContextThread=pega.ui.NavigateTopHandler.setContextThread;this.primaryThread=pega.ui.NavigateTopHandler.getPrimaryThreadName;this.runFlow=pega.ui.NavigateTopHandler.runFlow;this.rewriteURL=pega.ui.NavigateTopHandler.rewriteURL;this.historyGlobalState=0}})(pega);